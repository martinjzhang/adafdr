<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><title>Python: module adafdr.method</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head><body bgcolor="#f0f0f8">

<table width="100%" cellspacing=0 cellpadding=2 border=0 summary="heading">
<tr bgcolor="#7799ee">
<td valign=bottom>&nbsp;<br>
<font color="#ffffff" face="helvetica, arial">&nbsp;<br><big><big><strong><a href="adafdr.html"><font color="#ffffff">adafdr</font></a>.method</strong></big></big></font></td
><td align=right valign=bottom
><font color="#ffffff" face="helvetica, arial"><a href=".">index</a><br><a href="file:/home/martin/NeuralFDR2/adafdr/adafdr/method.py">/home/martin/NeuralFDR2/adafdr/adafdr/method.py</a></font></td></tr></table>
    <p></p>
<p>
<table width="100%" cellspacing=0 cellpadding=2 border=0 summary="section">
<tr bgcolor="#aa55cc">
<td colspan=3 valign=bottom>&nbsp;<br>
<font color="#ffffff" face="helvetica, arial"><big><strong>Modules</strong></big></font></td></tr>
    
<tr><td bgcolor="#aa55cc"><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</tt></td><td>&nbsp;</td>
<td width="100%"><table width="100%" summary="list"><tr><td width="25%" valign=top><a href="logging.html">logging</a><br>
<a href="multiprocessing.html">multiprocessing</a><br>
<a href="numpy.html">numpy</a><br>
</td><td width="25%" valign=top><a href="os.html">os</a><br>
<a href="pickle.html">pickle</a><br>
<a href="matplotlib.pyplot.html">matplotlib.pyplot</a><br>
</td><td width="25%" valign=top><a href="scipy.html">scipy</a><br>
<a href="scipy.stats.html">scipy.stats</a><br>
<a href="torch.nn.functional.html">torch.nn.functional</a><br>
</td><td width="25%" valign=top><a href="time.html">time</a><br>
<a href="torch.html">torch</a><br>
</td></tr></table></td></tr></table><p>
<table width="100%" cellspacing=0 cellpadding=2 border=0 summary="section">
<tr bgcolor="#eeaa77">
<td colspan=3 valign=bottom>&nbsp;<br>
<font color="#ffffff" face="helvetica, arial"><big><strong>Functions</strong></big></font></td></tr>
    
<tr><td bgcolor="#eeaa77"><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</tt></td><td>&nbsp;</td>
<td width="100%"><dl><dt><a name="-ML_bump"><strong>ML_bump</strong></a>(x, v=None, logger=None)</dt><dd><tt>ML&nbsp;fit&nbsp;of&nbsp;the&nbsp;bump&nbsp;function<br>
&nbsp;<br>
Parameters<br>
----------<br>
x&nbsp;:&nbsp;(n,d)&nbsp;ndarray<br>
&nbsp;&nbsp;&nbsp;&nbsp;coML&nbsp;estimatearaites<br>
v&nbsp;:&nbsp;(n,)&nbsp;ndarray&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;weight&nbsp;for&nbsp;each&nbsp;sample<br>
&nbsp;<br>
Returns<br>
-------<br>
mu&nbsp;:&nbsp;(n,d)&nbsp;ndarray<br>
&nbsp;&nbsp;&nbsp;&nbsp;bump&nbsp;mean&nbsp;parameter&nbsp;(for&nbsp;each&nbsp;dimension)<br>
sigma&nbsp;:&nbsp;(n,d)&nbsp;ndarray&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;bump&nbsp;std&nbsp;parameter&nbsp;(for&nbsp;each&nbsp;dimension)</tt></dd></dl>
 <dl><dt><a name="-ML_slope"><strong>ML_slope</strong></a>(x, v=None, c=0.005)</dt><dd><tt>ML&nbsp;fit&nbsp;of&nbsp;the&nbsp;slope&nbsp;a/(e^a-1)&nbsp;e^(ax),&nbsp;defined&nbsp;over&nbsp;[0,1]<br>
&nbsp;<br>
Parameters<br>
----------<br>
x&nbsp;:&nbsp;(n,d)&nbsp;ndarray<br>
&nbsp;&nbsp;&nbsp;&nbsp;covaraites<br>
v&nbsp;:&nbsp;(n,)&nbsp;ndarray&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;weight&nbsp;for&nbsp;each&nbsp;sample<br>
c&nbsp;:&nbsp;float<br>
&nbsp;&nbsp;&nbsp;&nbsp;regularization&nbsp;factor&nbsp;<br>
&nbsp;<br>
Returns<br>
-------<br>
(d,)&nbsp;ndarray<br>
&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;estiamted&nbsp;slope&nbsp;parameter</tt></dd></dl>
 <dl><dt><a name="-adafdr_explore"><strong>adafdr_explore</strong></a>(p, x_input, alpha=0.1, n_full=None, vis_dim=None, cate_name={}, output_folder=None, title_list=None, h=None)</dt><dd><tt>Provide&nbsp;a&nbsp;visualization&nbsp;of&nbsp;pi1/pi0&nbsp;for&nbsp;each&nbsp;dimension,<br>
to&nbsp;visualize&nbsp;the&nbsp;amount&nbsp;of&nbsp;information&nbsp;carried&nbsp;in&nbsp;each&nbsp;dimension.<br>
&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Args:<br>
&nbsp;&nbsp;&nbsp;&nbsp;p&nbsp;((n,)&nbsp;ndarray):&nbsp;the&nbsp;p-values.<br>
&nbsp;&nbsp;&nbsp;&nbsp;x_input&nbsp;((n,d)&nbsp;ndarray):&nbsp;The&nbsp;covaraites.&nbsp;The&nbsp;discrete&nbsp;features&nbsp;should&nbsp;be&nbsp;coded&nbsp;by<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;integers&nbsp;starting&nbsp;from&nbsp;0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;alpha&nbsp;(float):&nbsp;The&nbsp;nominal&nbsp;FDR&nbsp;level.<br>
&nbsp;&nbsp;&nbsp;&nbsp;n_full&nbsp;(int):&nbsp;Total&nbsp;number&nbsp;of&nbsp;hypotheses&nbsp;before&nbsp;filtering.<br>
&nbsp;&nbsp;&nbsp;&nbsp;vis_dim&nbsp;(list&nbsp;or&nbsp;ndarray):&nbsp;the&nbsp;dimensions&nbsp;to&nbsp;visualize<br>
&nbsp;&nbsp;&nbsp;&nbsp;cate_name&nbsp;(dic&nbsp;of&nbsp;dics):&nbsp;the&nbsp;names&nbsp;of&nbsp;discrete&nbsp;categories&nbsp;for&nbsp;each&nbsp;dimension.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;None&nbsp;when&nbsp;the&nbsp;category&nbsp;names&nbsp;are&nbsp;not&nbsp;available.&nbsp;An&nbsp;example&nbsp;is&nbsp;as&nbsp;follows:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cate_name&nbsp;=&nbsp;{1:&nbsp;{0:&nbsp;'name0',&nbsp;1:&nbsp;'name1'}}.&nbsp;Here,&nbsp;dimension&nbsp;0&nbsp;has<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;no&nbsp;names.&nbsp;Dimension&nbsp;1&nbsp;is&nbsp;discrete&nbsp;and&nbsp;has&nbsp;two&nbsp;values&nbsp;0,1,&nbsp;whose&nbsp;corresponding<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;names&nbsp;are&nbsp;name0,&nbsp;name1<br>
&nbsp;&nbsp;&nbsp;&nbsp;output_folder&nbsp;(string):&nbsp;The&nbsp;output&nbsp;directory.<br>
&nbsp;&nbsp;&nbsp;&nbsp;title_list&nbsp;(list&nbsp;of&nbsp;strings):&nbsp;Titles&nbsp;for&nbsp;each&nbsp;figure.&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;h&nbsp;((n,)&nbsp;ndarray):&nbsp;The&nbsp;ground&nbsp;truth&nbsp;(None&nbsp;if&nbsp;not&nbsp;available).&nbsp;<br>
&nbsp;<br>
Returns:</tt></dd></dl>
 <dl><dt><a name="-adafdr_test"><strong>adafdr_test</strong></a>(p_input, x_input, K=3, alpha=0.1, n_full=None, n_itr=1500, qt_norm=True, h=None, verbose=False, output_folder=None, random_state=0, single_core=False, fast_mode=False)</dt><dd><tt>Hypothesis&nbsp;testing&nbsp;with&nbsp;hypothesis&nbsp;splitting.<br>
&nbsp;<br>
Args:<br>
&nbsp;&nbsp;&nbsp;&nbsp;p_input&nbsp;((n,)&nbsp;ndarray):&nbsp;The&nbsp;p-values.<br>
&nbsp;&nbsp;&nbsp;&nbsp;x_input&nbsp;((n,d)&nbsp;ndarray):&nbsp;The&nbsp;covaraites.&nbsp;The&nbsp;discrete&nbsp;features&nbsp;should&nbsp;be&nbsp;coded&nbsp;by&nbsp;integers<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;starting&nbsp;from&nbsp;0.<br>
&nbsp;&nbsp;&nbsp;&nbsp;K&nbsp;(int):&nbsp;The&nbsp;number&nbsp;of&nbsp;bump&nbsp;components.<br>
&nbsp;&nbsp;&nbsp;&nbsp;alpha&nbsp;(float):&nbsp;The&nbsp;nominal&nbsp;FDR&nbsp;level.<br>
&nbsp;&nbsp;&nbsp;&nbsp;n_full&nbsp;(int):&nbsp;Total&nbsp;number&nbsp;of&nbsp;hypotheses&nbsp;before&nbsp;filtering.<br>
&nbsp;&nbsp;&nbsp;&nbsp;n_itr&nbsp;(int):&nbsp;The&nbsp;number&nbsp;of&nbsp;iterations&nbsp;for&nbsp;the&nbsp;optimization&nbsp;process.<br>
&nbsp;&nbsp;&nbsp;&nbsp;qt_norm&nbsp;(bool):&nbsp;If&nbsp;perform&nbsp;quantile&nbsp;normalization.<br>
&nbsp;&nbsp;&nbsp;&nbsp;h&nbsp;((n,)&nbsp;ndarray):&nbsp;The&nbsp;ground&nbsp;truth&nbsp;(None&nbsp;if&nbsp;not&nbsp;available).&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;verbose&nbsp;(bool):&nbsp;Indicate&nbsp;if&nbsp;output&nbsp;the&nbsp;computation&nbsp;details.<br>
&nbsp;&nbsp;&nbsp;&nbsp;output_folder&nbsp;(string):&nbsp;The&nbsp;output&nbsp;directory.<br>
&nbsp;&nbsp;&nbsp;&nbsp;random_state&nbsp;(int):&nbsp;The&nbsp;random&nbsp;seed.<br>
&nbsp;&nbsp;&nbsp;&nbsp;single_core&nbsp;(bool):&nbsp;True:&nbsp;use&nbsp;single&nbsp;core.&nbsp;False:&nbsp;process&nbsp;two&nbsp;processes&nbsp;in&nbsp;parallel.<br>
&nbsp;&nbsp;&nbsp;&nbsp;fast_mode&nbsp;(bool):&nbsp;If&nbsp;True,&nbsp;go&nbsp;without&nbsp;optimization.<br>
&nbsp;&nbsp;&nbsp;&nbsp;<br>
Returns:<br>
&nbsp;&nbsp;&nbsp;&nbsp;n_rej&nbsp;(list):&nbsp;Number&nbsp;of&nbsp;rejected&nbsp;hypothesesfor&nbsp;the&nbsp;two&nbsp;folds.<br>
&nbsp;&nbsp;&nbsp;&nbsp;t&nbsp;((n,)&nbsp;ndarray):&nbsp;The&nbsp;decision&nbsp;threshold.<br>
&nbsp;&nbsp;&nbsp;&nbsp;theta&nbsp;(list):&nbsp;Learned&nbsp;(reparametrized)&nbsp;parameters&nbsp;with&nbsp;the&nbsp;format&nbsp;[a,b,w,mu,sigma,gamma].</tt></dd></dl>
 <dl><dt><a name="-bh_test"><strong>bh_test</strong></a>(p, alpha=0.1, n_full=None, verbose=False)</dt></dl>
 <dl><dt><a name="-f_all"><strong>f_all</strong></a>(x, a, mu, sigma, w)</dt><dd><tt>density&nbsp;of&nbsp;the&nbsp;mixture&nbsp;model&nbsp;(slope+bump)<br>
&nbsp;<br>
Parameters<br>
----------<br>
x&nbsp;:&nbsp;(n,d)&nbsp;ndarray<br>
&nbsp;&nbsp;&nbsp;&nbsp;coML&nbsp;estimatearaites<br>
mu&nbsp;:&nbsp;(d,)&nbsp;ndarray&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;bump&nbsp;mean&nbsp;parameter&nbsp;(for&nbsp;each&nbsp;dimension)<br>
&nbsp;<br>
sigma&nbsp;:&nbsp;(d,)&nbsp;ndarray&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;bump&nbsp;std&nbsp;parameter&nbsp;(for&nbsp;each&nbsp;dimension)<br>
&nbsp;<br>
Returns<br>
-------<br>
(n,)&nbsp;array<br>
&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;bump&nbsp;density&nbsp;for&nbsp;each&nbsp;point</tt></dd></dl>
 <dl><dt><a name="-f_bump"><strong>f_bump</strong></a>(x, mu, sigma)</dt><dd><tt>density&nbsp;of&nbsp;the&nbsp;bump&nbsp;function<br>
&nbsp;<br>
Parameters<br>
----------<br>
x&nbsp;:&nbsp;(n,d)&nbsp;ndarray<br>
&nbsp;&nbsp;&nbsp;&nbsp;coML&nbsp;estimatearaites<br>
mu&nbsp;:&nbsp;(d,)&nbsp;ndarray&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;bump&nbsp;mean&nbsp;parameter&nbsp;(for&nbsp;each&nbsp;dimension)<br>
&nbsp;<br>
sigma&nbsp;:&nbsp;(d,)&nbsp;ndarray&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;bump&nbsp;std&nbsp;parameter&nbsp;(for&nbsp;each&nbsp;dimension)<br>
&nbsp;<br>
Returns<br>
-------<br>
(n,)&nbsp;array<br>
&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;bump&nbsp;density&nbsp;for&nbsp;each&nbsp;point</tt></dd></dl>
 <dl><dt><a name="-f_slope"><strong>f_slope</strong></a>(x, a)</dt><dd><tt>density&nbsp;of&nbsp;the&nbsp;slope&nbsp;function<br>
&nbsp;<br>
Parameters<br>
----------<br>
x&nbsp;:&nbsp;(n,d)&nbsp;ndarray<br>
&nbsp;&nbsp;&nbsp;&nbsp;coML&nbsp;estimatearaites<br>
a&nbsp;:&nbsp;(d,)&nbsp;ndarray&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;slope&nbsp;parameter&nbsp;(for&nbsp;each&nbsp;dimension)<br>
&nbsp;<br>
Returns<br>
-------<br>
(n,)&nbsp;array<br>
&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;slope&nbsp;density&nbsp;for&nbsp;each&nbsp;point</tt></dd></dl>
 <dl><dt><a name="-feature_preprocess"><strong>feature_preprocess</strong></a>(x, qt_norm=True, continous_rank=True)</dt><dd><tt>Feature&nbsp;preprocessing:&nbsp;1.&nbsp;quantile&nbsp;normalization,&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;2.&nbsp;make&nbsp;the&nbsp;range&nbsp;[0,1]&nbsp;for&nbsp;each&nbsp;feature<br>
&nbsp;<br>
Args:<br>
&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;((n,d)&nbsp;ndarray):&nbsp;The&nbsp;covaraites.<br>
&nbsp;&nbsp;&nbsp;&nbsp;qt_norm&nbsp;(bool):&nbsp;If&nbsp;perform&nbsp;quantile&nbsp;normalization.<br>
&nbsp;&nbsp;&nbsp;&nbsp;continous_rank&nbsp;(bool):&nbsp;Indicate&nbsp;if&nbsp;break&nbsp;the&nbsp;same&nbsp;value&nbsp;by&nbsp;randomization.<br>
&nbsp;&nbsp;&nbsp;&nbsp;<br>
Returns:<br>
&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;((n,d)&nbsp;ndarray):&nbsp;The&nbsp;discrete&nbsp;feature&nbsp;is&nbsp;reordered&nbsp;based&nbsp;on&nbsp;the&nbsp;alt/null&nbsp;ratio.</tt></dd></dl>
 <dl><dt><a name="-get_feature_type"><strong>get_feature_type</strong></a>(x)</dt><dd><tt>Tell&nbsp;if&nbsp;a&nbsp;feature&nbsp;is&nbsp;continuous&nbsp;or&nbsp;discrete.</tt></dd></dl>
 <dl><dt><a name="-get_order_discrete"><strong>get_order_discrete</strong></a>(p, x, x_val, n_full=None)</dt><dd><tt>Calculate&nbsp;the&nbsp;order&nbsp;of&nbsp;the&nbsp;discrete&nbsp;features&nbsp;according&nbsp;to&nbsp;the&nbsp;alt/null&nbsp;ratio<br>
Args:<br>
&nbsp;&nbsp;&nbsp;&nbsp;p&nbsp;((n,)&nbsp;ndarray):&nbsp;The&nbsp;p-values.<br>
&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;((n,)&nbsp;ndarray):&nbsp;The&nbsp;covaraites.&nbsp;The&nbsp;data&nbsp;is&nbsp;assumed&nbsp;to&nbsp;have&nbsp;been&nbsp;preprocessed.<br>
&nbsp;&nbsp;&nbsp;&nbsp;x_val&nbsp;((n_val,)&nbsp;ndarray):&nbsp;All&nbsp;possible&nbsp;values&nbsp;for&nbsp;x,&nbsp;sorted&nbsp;in&nbsp;ascending&nbsp;order.<br>
&nbsp;&nbsp;&nbsp;&nbsp;n_full&nbsp;(int):&nbsp;Total&nbsp;number&nbsp;of&nbsp;hypotheses&nbsp;before&nbsp;filtering.&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<br>
Returns:<br>
&nbsp;&nbsp;&nbsp;&nbsp;x_order&nbsp;((d,)&nbsp;ndarray):&nbsp;the&nbsp;order&nbsp;(of&nbsp;x_val)&nbsp;from&nbsp;smallest&nbsp;alt/null&nbsp;ratio&nbsp;to&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;largest.</tt></dd></dl>
 <dl><dt><a name="-method_init"><strong>method_init</strong></a>(p_input, x_input, K, alpha=0.1, n_full=None, h=None, verbose=False, output_folder=None, random_state=0, fold_number=0, f_write=None)</dt><dd><tt>Initialization&nbsp;for&nbsp;method_single_fold&nbsp;that&nbsp;fits&nbsp;a&nbsp;mixture&nbsp;model&nbsp;with&nbsp;bump+slope.<br>
&nbsp;<br>
Args:<br>
&nbsp;&nbsp;&nbsp;&nbsp;p_input&nbsp;((n,)&nbsp;ndarray):&nbsp;The&nbsp;p-values<br>
&nbsp;&nbsp;&nbsp;&nbsp;x_input&nbsp;((n,d)&nbsp;ndarray):&nbsp;The&nbsp;covaraites.<br>
&nbsp;&nbsp;&nbsp;&nbsp;K&nbsp;(int):&nbsp;The&nbsp;number&nbsp;of&nbsp;bump&nbsp;components.<br>
&nbsp;&nbsp;&nbsp;&nbsp;alpha&nbsp;(float):&nbsp;The&nbsp;nominal&nbsp;FDR&nbsp;level.<br>
&nbsp;&nbsp;&nbsp;&nbsp;n_full&nbsp;(int):&nbsp;Total&nbsp;number&nbsp;of&nbsp;hypotheses&nbsp;before&nbsp;filtering.<br>
&nbsp;&nbsp;&nbsp;&nbsp;h&nbsp;((n,)&nbsp;ndarray):&nbsp;The&nbsp;ground&nbsp;truth&nbsp;(None&nbsp;if&nbsp;not&nbsp;available).<br>
&nbsp;&nbsp;&nbsp;&nbsp;verbose&nbsp;(bool):&nbsp;Indicate&nbsp;if&nbsp;output&nbsp;the&nbsp;computation&nbsp;details.<br>
&nbsp;&nbsp;&nbsp;&nbsp;output_folder&nbsp;(string):&nbsp;The&nbsp;output&nbsp;directory.<br>
&nbsp;&nbsp;&nbsp;&nbsp;random_state&nbsp;(int):&nbsp;The&nbsp;random&nbsp;seed.<br>
&nbsp;&nbsp;&nbsp;&nbsp;fold_number&nbsp;(int(0,1)):&nbsp;The&nbsp;fold&nbsp;number.<br>
&nbsp;&nbsp;&nbsp;&nbsp;f_write&nbsp;(file&nbsp;handler&nbsp;(write&nbsp;mode)):&nbsp;The&nbsp;output&nbsp;file.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<br>
Returns:<br>
&nbsp;&nbsp;&nbsp;&nbsp;a&nbsp;((d,)&nbsp;ndarray):&nbsp;slope&nbsp;parameter.<br>
&nbsp;&nbsp;&nbsp;&nbsp;mu,sigma&nbsp;((k,d)&nbsp;ndarray):&nbsp;bump&nbsp;parameter.<br>
&nbsp;&nbsp;&nbsp;&nbsp;w&nbsp;((n,)&nbsp;ndarray):&nbsp;proportion&nbsp;of&nbsp;each&nbsp;component.</tt></dd></dl>
 <dl><dt><a name="-method_single_fold"><strong>method_single_fold</strong></a>(p_input, x_input, K=5, alpha=0.1, n_full=None, n_itr=1500, h=None, verbose=False, output_folder=None, fold_number=0, random_state=0, f_write=None, fast_mode=False)</dt><dd><tt>Learn&nbsp;the&nbsp;decision&nbsp;threshold&nbsp;via&nbsp;optimization.<br>
&nbsp;<br>
Args:<br>
&nbsp;&nbsp;&nbsp;&nbsp;p_input&nbsp;((n,)&nbsp;ndarray):&nbsp;The&nbsp;p-values.<br>
&nbsp;&nbsp;&nbsp;&nbsp;x_input&nbsp;((n,d)&nbsp;ndarray):&nbsp;The&nbsp;covaraites.&nbsp;The&nbsp;data&nbsp;is&nbsp;assumed&nbsp;to&nbsp;have&nbsp;been&nbsp;preprocessed.<br>
&nbsp;&nbsp;&nbsp;&nbsp;K&nbsp;(int):&nbsp;The&nbsp;number&nbsp;of&nbsp;bump&nbsp;components.<br>
&nbsp;&nbsp;&nbsp;&nbsp;alpha&nbsp;(float):&nbsp;The&nbsp;nominal&nbsp;FDR&nbsp;level.<br>
&nbsp;&nbsp;&nbsp;&nbsp;n_full&nbsp;(int):&nbsp;Total&nbsp;number&nbsp;of&nbsp;hypotheses&nbsp;before&nbsp;filtering.<br>
&nbsp;&nbsp;&nbsp;&nbsp;n_itr&nbsp;(int):&nbsp;The&nbsp;number&nbsp;of&nbsp;iterations&nbsp;for&nbsp;the&nbsp;optimization&nbsp;process.<br>
&nbsp;&nbsp;&nbsp;&nbsp;h&nbsp;((n,)&nbsp;ndarray):&nbsp;The&nbsp;ground&nbsp;truth&nbsp;(None&nbsp;if&nbsp;not&nbsp;available).&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;verbose&nbsp;(bool):&nbsp;Indicate&nbsp;if&nbsp;output&nbsp;the&nbsp;computation&nbsp;details.<br>
&nbsp;&nbsp;&nbsp;&nbsp;output_folder&nbsp;(string):&nbsp;The&nbsp;output&nbsp;directory.<br>
&nbsp;&nbsp;&nbsp;&nbsp;random_state&nbsp;(int):&nbsp;The&nbsp;random&nbsp;seed.<br>
&nbsp;&nbsp;&nbsp;&nbsp;fold_number&nbsp;(int(0,1)):&nbsp;The&nbsp;fold&nbsp;number.<br>
&nbsp;&nbsp;&nbsp;&nbsp;f_write&nbsp;(file&nbsp;handler&nbsp;(write&nbsp;mode)):&nbsp;The&nbsp;output&nbsp;file.<br>
&nbsp;&nbsp;&nbsp;&nbsp;fast_mode&nbsp;(bool):&nbsp;If&nbsp;True,&nbsp;go&nbsp;without&nbsp;optimization.<br>
&nbsp;&nbsp;&nbsp;&nbsp;<br>
Returns:<br>
&nbsp;&nbsp;&nbsp;&nbsp;n_rej&nbsp;(int):&nbsp;Number&nbsp;of&nbsp;rejected&nbsp;hypotheses.<br>
&nbsp;&nbsp;&nbsp;&nbsp;t&nbsp;((n,)&nbsp;ndarray):&nbsp;The&nbsp;decision&nbsp;threshold.<br>
&nbsp;&nbsp;&nbsp;&nbsp;theta&nbsp;(list):&nbsp;Learned&nbsp;(reparametrized)&nbsp;parameters&nbsp;with&nbsp;the&nbsp;format&nbsp;[a,b,w,mu,sigma,gamma].</tt></dd></dl>
 <dl><dt><a name="-method_single_fold_wrapper"><strong>method_single_fold_wrapper</strong></a>(data)</dt><dd><tt>A&nbsp;wrapper&nbsp;for&nbsp;method_single_fold&nbsp;to&nbsp;be&nbsp;called&nbsp;by&nbsp;method_cv<br>
&nbsp;<br>
Args:<br>
&nbsp;&nbsp;&nbsp;&nbsp;data&nbsp;(list):&nbsp;data[0]:&nbsp;p1,&nbsp;x1,&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data[1]:&nbsp;p2,&nbsp;x2,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data[2]:&nbsp;K,alpha,n_full,n_itr,output_folder,random_state,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data[3]:&nbsp;Fold&nbsp;number.<br>
&nbsp;&nbsp;&nbsp;&nbsp;<br>
Returns:<br>
&nbsp;&nbsp;&nbsp;&nbsp;n_rej&nbsp;(int):&nbsp;Number&nbsp;of&nbsp;rejected&nbsp;hypotheses.<br>
&nbsp;&nbsp;&nbsp;&nbsp;t2&nbsp;((n/2,)&nbsp;ndarray):&nbsp;The&nbsp;thresholds&nbsp;on&nbsp;the&nbsp;second&nbsp;fold&nbsp;of&nbsp;data.<br>
&nbsp;&nbsp;&nbsp;&nbsp;[a,b,w,mu,sigma,gamma]:&nbsp;Learned&nbsp;(reparametrized)&nbsp;parameters.</tt></dd></dl>
 <dl><dt><a name="-mixture_fit"><strong>mixture_fit</strong></a>(x, K=3, x_w=None, n_itr=100, verbose=False, random_state=0, f_write=None, output_folder=None, suffix=None, fold_number=0)</dt><dd><tt>Fit&nbsp;a&nbsp;slope+bump&nbsp;mixture&nbsp;using&nbsp;EM&nbsp;algorithm.<br>
&nbsp;<br>
Args:<br>
&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;((n,d)&nbsp;ndarray):&nbsp;The&nbsp;covaraites.<br>
&nbsp;&nbsp;&nbsp;&nbsp;K&nbsp;(int):&nbsp;The&nbsp;number&nbsp;of&nbsp;bump&nbsp;components.<br>
&nbsp;&nbsp;&nbsp;&nbsp;x_w&nbsp;((n,)&nbsp;ndarray):&nbsp;The&nbsp;weights&nbsp;for&nbsp;each&nbsp;sample.<br>
&nbsp;&nbsp;&nbsp;&nbsp;n_itr&nbsp;(int):&nbsp;The&nbsp;maximum&nbsp;number&nbsp;of&nbsp;iterations&nbsp;for&nbsp;the&nbsp;EM&nbsp;algorithm<br>
&nbsp;&nbsp;&nbsp;&nbsp;verbose&nbsp;(bool):&nbsp;Indicate&nbsp;if&nbsp;output&nbsp;the&nbsp;computation&nbsp;details.<br>
&nbsp;&nbsp;&nbsp;&nbsp;random_state&nbsp;(int):&nbsp;The&nbsp;random&nbsp;seed.<br>
&nbsp;&nbsp;&nbsp;&nbsp;f_write&nbsp;(file&nbsp;handler&nbsp;(write&nbsp;mode)):&nbsp;The&nbsp;output&nbsp;file.<br>
&nbsp;&nbsp;&nbsp;&nbsp;output_folder&nbsp;(string):&nbsp;The&nbsp;output&nbsp;directory.<br>
&nbsp;&nbsp;&nbsp;&nbsp;suffix&nbsp;(string):&nbsp;The&nbsp;suffix&nbsp;of&nbsp;the&nbsp;output&nbsp;file.<br>
&nbsp;&nbsp;&nbsp;&nbsp;fold_number&nbsp;(int(0,1)):&nbsp;The&nbsp;fold&nbsp;number.<br>
&nbsp;<br>
Returns:<br>
&nbsp;&nbsp;&nbsp;&nbsp;a&nbsp;((d,)&nbsp;ndarray):&nbsp;slope&nbsp;parameter.<br>
&nbsp;&nbsp;&nbsp;&nbsp;mu,sigma&nbsp;((k,d)&nbsp;ndarray):&nbsp;bump&nbsp;parameter.<br>
&nbsp;&nbsp;&nbsp;&nbsp;w&nbsp;((n,)&nbsp;ndarray):&nbsp;proportion&nbsp;of&nbsp;each&nbsp;component.</tt></dd></dl>
 <dl><dt><a name="-preprocess_two_fold"><strong>preprocess_two_fold</strong></a>(p1, x1, x2, n_full, f_write)</dt><dd><tt>Data&nbsp;preprocessing&nbsp;two&nbsp;folds&nbsp;of&nbsp;data.&nbsp;Note&nbsp;that&nbsp;to&nbsp;prevent&nbsp;overfitting,<br>
the&nbsp;preprocessing&nbsp;procedure&nbsp;does&nbsp;not&nbsp;depend&nbsp;on&nbsp;the&nbsp;p-values&nbsp;from&nbsp;the&nbsp;second&nbsp;fold.<br>
&nbsp;<br>
Args:<br>
&nbsp;&nbsp;&nbsp;&nbsp;p1&nbsp;((n1,)&nbsp;ndarray):&nbsp;the&nbsp;p-value&nbsp;from&nbsp;the&nbsp;first&nbsp;fold.<br>
&nbsp;&nbsp;&nbsp;&nbsp;x1&nbsp;((n1,d)&nbsp;ndarray):&nbsp;the&nbsp;covariates&nbsp;from&nbsp;the&nbsp;first&nbsp;fold.<br>
&nbsp;&nbsp;&nbsp;&nbsp;x2&nbsp;((n1,d)&nbsp;ndarray):&nbsp;the&nbsp;covariates&nbsp;from&nbsp;the&nbsp;second&nbsp;fold.<br>
&nbsp;&nbsp;&nbsp;&nbsp;n_full&nbsp;(int):&nbsp;Total&nbsp;number&nbsp;of&nbsp;hypotheses&nbsp;before&nbsp;filtering.<br>
&nbsp;<br>
Returns:<br>
&nbsp;&nbsp;&nbsp;&nbsp;x1&nbsp;((n1,d)&nbsp;ndarray):&nbsp;the&nbsp;preprocessed&nbsp;covariates&nbsp;from&nbsp;the&nbsp;first&nbsp;fold.<br>
&nbsp;&nbsp;&nbsp;&nbsp;x2&nbsp;((n1,d)&nbsp;ndarray):&nbsp;the&nbsp;preprocessed&nbsp;covariates&nbsp;from&nbsp;the&nbsp;second&nbsp;fold.</tt></dd></dl>
 <dl><dt><a name="-reorder_discrete"><strong>reorder_discrete</strong></a>(x, x_val, x_order)</dt><dd><tt>Reorder&nbsp;the&nbsp;covariates&nbsp;based&nbsp;on&nbsp;the&nbsp;new&nbsp;order.<br>
Args:<br>
&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;((n,)&nbsp;ndarray):&nbsp;The&nbsp;covaraites.<br>
&nbsp;&nbsp;&nbsp;&nbsp;x_val&nbsp;((n_val,)&nbsp;ndarray):&nbsp;All&nbsp;possible&nbsp;values&nbsp;for&nbsp;x,&nbsp;sorted&nbsp;in&nbsp;ascending&nbsp;order.<br>
&nbsp;&nbsp;&nbsp;&nbsp;x_order&nbsp;((n_val,)&nbsp;ndarray):&nbsp;The&nbsp;new&nbsp;order&nbsp;of&nbsp;x_val.<br>
&nbsp;&nbsp;&nbsp;&nbsp;<br>
Returns:<br>
&nbsp;&nbsp;&nbsp;&nbsp;x_new&nbsp;((d,)&nbsp;ndarray):&nbsp;the&nbsp;reordered&nbsp;covaraites.</tt></dd></dl>
 <dl><dt><a name="-reparametrize"><strong>reparametrize</strong></a>(a_init, mu_init, sigma_init, w_init, d)</dt><dd><tt>Learn&nbsp;the&nbsp;decision&nbsp;threshold&nbsp;via&nbsp;optimization.<br>
&nbsp;<br>
Args:<br>
&nbsp;&nbsp;&nbsp;&nbsp;a_init&nbsp;((d,)&nbsp;ndarray):&nbsp;slope&nbsp;parameter.<br>
&nbsp;&nbsp;&nbsp;&nbsp;mu_init,sigma_init&nbsp;((K,d)&nbsp;ndarray):&nbsp;bump&nbsp;parameter.<br>
&nbsp;&nbsp;&nbsp;&nbsp;w_init&nbsp;((n,)&nbsp;ndarray):&nbsp;proportion&nbsp;of&nbsp;each&nbsp;component.<br>
&nbsp;&nbsp;&nbsp;&nbsp;d&nbsp;(int):&nbsp;The&nbsp;dimensionality.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<br>
Returns:<br>
&nbsp;&nbsp;&nbsp;&nbsp;Parameters&nbsp;used&nbsp;in&nbsp;optimizataion&nbsp;and&nbsp;t_cal.<br>
&nbsp;&nbsp;&nbsp;&nbsp;a&nbsp;((d,)&nbsp;ndarray):&nbsp;slope&nbsp;parameter.<br>
&nbsp;&nbsp;&nbsp;&nbsp;mu,sigma&nbsp;((K,d)&nbsp;ndarray):&nbsp;bump&nbsp;parameter.<br>
&nbsp;&nbsp;&nbsp;&nbsp;w&nbsp;((n,)&nbsp;ndarray):&nbsp;proportion&nbsp;of&nbsp;each&nbsp;component.</tt></dd></dl>
 <dl><dt><a name="-rescale_mirror"><strong>rescale_mirror</strong></a>(t, p, alpha, f_write=None, title='')</dt><dd><tt>Rescale&nbsp;to&nbsp;have&nbsp;the&nbsp;mirror&nbsp;estimate&nbsp;below&nbsp;level&nbsp;alpha<br>
&nbsp;<br>
Args:<br>
&nbsp;&nbsp;&nbsp;&nbsp;t&nbsp;((n,)&nbsp;ndarray):&nbsp;The&nbsp;threshold&nbsp;for&nbsp;each&nbsp;hypothesis.<br>
&nbsp;&nbsp;&nbsp;&nbsp;p&nbsp;((n,)&nbsp;ndarray):&nbsp;The&nbsp;p-value&nbsp;for&nbsp;each&nbsp;hypothesis.<br>
&nbsp;&nbsp;&nbsp;&nbsp;alpha&nbsp;(float):&nbsp;The&nbsp;nominal&nbsp;FDR&nbsp;level.<br>
&nbsp;&nbsp;&nbsp;&nbsp;f_write&nbsp;(file&nbsp;handle):&nbsp;The&nbsp;file&nbsp;to&nbsp;write&nbsp;on.<br>
&nbsp;&nbsp;&nbsp;&nbsp;title&nbsp;(String):&nbsp;A&nbsp;description&nbsp;of&nbsp;the&nbsp;task.&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<br>
Returns:<br>
&nbsp;&nbsp;&nbsp;&nbsp;(float):&nbsp;the&nbsp;rescale&nbsp;factor.</tt></dd></dl>
 <dl><dt><a name="-sbh_test"><strong>sbh_test</strong></a>(p, alpha=0.1, lamb=0.5, n_full=None, verbose=False)</dt></dl>
 <dl><dt><a name="-t_cal"><strong>t_cal</strong></a>(x, a, b, w, mu, sigma)</dt><dd><tt>Calculate&nbsp;the&nbsp;threshold&nbsp;based&nbsp;on&nbsp;the&nbsp;learned&nbsp;mixture:&nbsp;trend+bump<br>
&nbsp;<br>
Args:<br>
&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;((n,d)&nbsp;ndarray):&nbsp;The&nbsp;covaraites.<br>
&nbsp;&nbsp;&nbsp;&nbsp;a&nbsp;((d,)&nbsp;ndarray):&nbsp;reparametrized&nbsp;slope&nbsp;parameter.<br>
&nbsp;&nbsp;&nbsp;&nbsp;mu,sigma&nbsp;((K,d)&nbsp;ndarray):&nbsp;reparametrized&nbsp;bump&nbsp;parameter.<br>
&nbsp;&nbsp;&nbsp;&nbsp;w&nbsp;((n,)&nbsp;ndarray):&nbsp;reparametrized&nbsp;proportion&nbsp;of&nbsp;each&nbsp;component.<br>
&nbsp;&nbsp;&nbsp;&nbsp;<br>
Returns:<br>
&nbsp;&nbsp;&nbsp;&nbsp;t&nbsp;((n,)&nbsp;ndarray):&nbsp;threshold&nbsp;for&nbsp;each&nbsp;hypothesis.</tt></dd></dl>
</td></tr></table>
</body></html>